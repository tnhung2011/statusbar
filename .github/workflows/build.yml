name: Build executable

on:
  push:
    branches: [ "master" ]
  pull_request:
    branches: [ "master" ]

env:
  name: statusbar
  CARGO_TERM_COLOR: always

jobs:
  build:
    strategy:
      matrix:
        arch: [x86, x64]
    runs-on: windows-latest

    steps:
    - uses: actions/checkout@v3
    - name: Install WebView2
      uses: crazy-max/ghaction-chocolatey@v2
      with:
        args: install webview2-runtime
    - name: Tauri build
      uses: tauri-apps/tauri-action@v0
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        tagName: ${{ env.name }}-v__VERSION__
        releaseName: '${{ env.name }} v__VERSION__'
        releaseBody: 'See the assets to download this version and install.'
        releaseDraft: true
        prerelease: false
